---
title: 'Для разработки'
---


:::info
Для установки сервера приложений, IDE и клиента на компьютере должна быть предварительно установлена Java версии не ниже 8.
:::


:::info
Для работы сервера приложений должен быть открыт доступ к серверу управления базами данных PostgreSQL версии не ниже 9.6. PostgreSQL сервер должен принимать подключения, используя авторизацию по паролю методом md5 или trust. Настроить авторизацию можно, отредактировав файл `pg_hba.conf`, как это описано в [документации](http://www.postgresql.org/docs/9.2/static/auth-pg-hba-conf.html) PostgreSQL.
:::

### Установка плагина к IDE


:::info
Для установки плагина на компьютере должна быть установлена Intellij IDEA не ниже 2020.1 версии.
:::

<iframe width="245px" height="48px" src="https://plugins.jetbrains.com/embeddable/install/7601"></iframe>

### Установка сервера приложений через IDE

-   При [создании нового lsFusion проекта](IDE.md#newproject) напротив `lsFusion library` нажать кнопку `Download`: IDEA автоматически скачает jar-файл последней (не beta) версии сервера lsFusion с [центрального сервера](https://download.lsfusion.org/java) и установит этот файл в качестве зависимости этого проекта (а точнее единственного его модуля: `File > Project Structure > Modules > имя проекта > вкладка Dependencies`). Также, при необходимости, можно скачать другую (отличную от последней) версию сервера или выбрать уже скачанный jar-файл сервера на локальном диске.  


:::info
Отметим, что IDEA запоминает скачанный / указанный файл сервера приложений в своих настройках и автоматически подставляет его при создании других lsFusion проектов. 
:::

### Установка десктоп-клиента

-   После старта сервера, в логе старта одной из последних строк будет строка с ссылкой на jnlp-файл (например <https://download.lsfusion.org/java/lsfusion-client-5.1.jnlp>), запустив который клиент автоматически установится при помощи технологии Java Web Start.

### Установка веб-клиента

-   Установить [Apache Tomcat](https://tomcat.apache.org/download-90.cgi) 9й версии.
-   Скачать [веб-клиента](https://download.lsfusion.org/java/lsfusion-client-5.1.war) платформы lsFusion.
-   Поместить war-файл в папку webapps Apache Tomcat, например, с именем lsfusion.war.
-   Веб-клиент будет доступен по адресу http://localhost:8080/lsfusion.

## Установка в существующих Java-проектах

### Установка сервера приложений через IDE {#existingide}

-   Скачать файл `lsfusion-server-<version>.jar` нужной версии (например `lsfusion-server-5.1.jar`) с [центрального сервера](https://download.lsfusion.org/java) в папку нужного модуля проекта (далее будем называть эту папку `$FUSION_DIR$`).
-   Если сервер БД находится на другом компьютере, а также если на сервере БД включена авторизация (например, для Postgres, по методу md5 и пароль postgres не пустой), задать [параметры подключения к серверу БД](Launch_parameters.md#connectdb) (например, создав [файл настроек](Launch_parameters.md#filesettings) запуска в папке проекта)
-   Добавить скачанный файл в качестве зависимости нужного модуля проекта (`File > Project Structure > Modules > имя модуля > вкладка Dependencies > +`) 
-   Создать [конфигурацию запуска](IDE.md#configuration) (при создании нового lsFusion проекта этот и верхние два пункта выполняются автоматически). Если платформа подключается в качестве библиотеки, вместо создания конфигурации можно использовать Spring bean c идентификатором `logicsInstance` из конфигурационного файл `lsfusion.xml`, и его методы `start()` и `stop()` отвечающий за старт и остановку сервера приложений соответственно.


:::info
Для существующего maven-проекта установку и подключение сервера можно (и нужно) делать по другому (см. ниже). 
:::

### Установка сервера приложений через Maven (только для Maven проектов) {#maven}

-   Прописать в `pom.xml` или в качестве parent `lsfusion.platform.build:logics`, или в качестве dependency `lsfusion.platform:server` (на данный момент эти артефакты не находятся в центральном репозитарии, поэтому дополнительно необходимо прописать путь к lsFusion-репозитарию), например:
    ```xml
    <repositories>
        <repository>
            <id>lsfusion</id>
            <name>lsFusion Public Repository</name>
            <url>https://repo.lsfusion.org</url>
        </repository>
    </repositories>

    <parent>
        <groupId>lsfusion.platform.build</groupId>
        <artifactId>logics</artifactId>
        <version>5.1</version>
    </parent>
    ```
    Первый вариант (с parent) хорош тем, что:

    -   Maven автоматически настроит сборку uber-jar (то есть один файл содержащий все файлы проекта). Запустить эту сборку можно используя maven-профиль `assemble` - при его включении на фазе package дополнительно формируется jar-файл с постфиксом `assembly`, который содержит не только файлы этого проекта, но и файлы всех зависимостей проекта, в том числе файлы самого сервера приложений. Впрочем, в случаях когда сервер приложений устанавливается отдельно от самого приложения (например, при [автоматической установке](Execution_auto.md)) включение сервера приложения в результирующий uber-jar нежелательно. Поэтому, помимо `assemble`, в платформе также поддерживается maven-профиль `noserver`, при включении которого (вместе с `assemble`) при формировании jar-файла с постфиксом `assembly` туда не будут включаться файлы сервера приложений (пример команды: `mvn package -P assemble,noserver`).

    -   Maven и IDE автоматически определят source и resources директории (например таким по умолчанию является `src/main/lsfusion`)

    -   Maven автоматически настроит weav'инг аспектов сервера приложений. Впрочем, это необходимо в достаточно редких случаях: если в проекте есть прикладные rmi-сервера (то есть объекты наследующие `lsfusion.interop.server.RmiServerInterface`, доступ которыми осуществляется удаленно через RMI) или используются различные системные аннотации сервера приложений (например `lsfusion.server.base.caches.IdentityLazy` для кэширования результатов выполнения).

    По втором варианте все вышеперечисленное необходимо настраивать вручную непосредственно разработчику.

    Также как и для других проектов, не созданных при помощи операции создания нового lsFusion проекта, для maven-проекта необходимо вручную создать [файл настроек](Launch_parameters.md#filesettings) и [конфигурацию запуска](IDE.md#configuration) (или если платформу необходимо подключить в качестве библиотеки использовать [специальный Spring bean](#existingide))


:::info
Если работа идет с большим проектом и в нем активно используются [метакоды](Metaprogramming.md) (например [ERP](https://github.com/lsfusion-solutions/erp)), рекомендуется в параметрах запуска IDEA (`idea.exe.vmoptions` или `idea64.exe.vmoptions`) увеличить `Xmx` хотя бы до 2gb.
:::
