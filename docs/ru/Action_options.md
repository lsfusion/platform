---
title: 'Опции действия'
---

При объявлении [действия](Actions.md) в [инструкции `ACTION`](ACTION_statement.md) в конце объявления может указываться некоторый набор *опций действия*. 

## Синтаксис

Опции перечисляются друг за другом в произвольном порядке через пробел или переводы строк:

```
propertyOption1 ... propertyOptionN
```

Поддерживается следующий набор опций (синтаксис каждой опции указывается в отдельной строке):

```
IN groupName
viewType
ON eventType { actionOperator }
CHANGEKEY key [SHOW | HIDE]
CHANGEMOUSE key [SHOW | HIDE]
STICKY | NOSTICKY
syncType
ASON eventType [ACTION] propertyId
imageSetting
annotationSetting
CONFIRM
EXTID extID
```

## Описание и параметры

- `IN groupName`

    Указание [группы свойств и действий](Groups_of_properties_and_actions.md), к которой принадлежит действие. Если опция не указывается, то действие по умолчанию будет принадлежать группе `System.private`.

    - `groupName`
    
        Имя группы. [Составной идентификатор](IDs.md#cid).

### Блок интерактивного представления

- `viewType`

    Указание типа [представления действия](Interactive_view.md#property) при добавлении на форму.

    - `GRID` - колонка таблицы
    - `TOOLBAR` - тулбар
    - `PANEL` - панель

  По действию аналогично указанию опции viewType в [блоке свойств](Properties_and_actions_block.md) [инструкции `FORM`](FORM_statement.md). Соответственно, если эта опция не указана ни в опциях действий, ни в блоке свойств непосредственно на форме, используется тип [представления по умолчанию](Interactive_view.md#property) для группы отображения, добавляемого на форму действия.

- `ON eventType { actionOperator }`

    Указание действия, которое будет обработкой по умолчанию некоторого [события](Form_events.md) всех интерактивных представлений этого действия. Могут быть переопределены в блоке свойств инструкции `FORM`.

    - `eventType`

        Тип [события формы](Form_events.md), задается одним из следующих ключевых слов:

        - `CHANGE` - попытка изменения значения указанного свойства
        - `CHANGEWYS` - попытка изменения значения указанного свойства с помощью специального механизма ввода. Подробнее можно прочитать в описании [событий формы](Form_events.md) 
        - `GROUPCHANGE` - попытка изменения значения свойства для всех объектов в таблице (групповое редактирование)
        - `EDIT` - попытка редактирования объекта, который является значением указанного свойства
        - `CONTEXTMENU [caption]` - пользователь выбрал в контекстном меню свойства на форме заданный пункт. Также при необходимости можно задать заголовок этого пункта меню ([строковый литерал](Literals.md#strliteral)). Если этого не сделать, то, по умолчанию, он будет равен заголовку действия.

    - `actionOperator`

        [Контекстно-зависимый оператор-действие](Action_operators.md). Оператор, описывающий выполняемое по событию действие. В качестве параметров оператора можно использовать параметры самого свойства.

- `ASON eventType [ACTION] propertyId`

    Указание того, что это действие будет являться обработкой по умолчанию некоторого [события](Form_events.md) всех интерактивных представлений заданного свойства или действия. Может быть переопределено в [блоке свойств и действий](Properties_and_actions_block.md) инструкции `FORM`. 

    - `eventType`

        Аналогично блоку `ON`.

    - `propertyId`

        [Идентификатор свойства или действия](IDs.md#propertyid), для которого создаваемое действие будет выполняться при возникновении указанного события формы.

    - `ACTION`

        Ключевое слово. Если задано, то считается, что в `propertyId` задается действие. Если не задано, первоначально считается, что в `propertyId` задается свойство, и только если оно не найдено, что в `propertyId` задается действие.

- `imageSetting`

    Настройка иконки, которая будет отображаться для действия. Эта опция позволяет настроить отображение иконки вручную. Может иметь один из двух видов:

    - `IMAGE [imageLiteral]`

        [Указание иконки](Icons.md#manual), которая будет отображаться в качестве иконки действия. Если `imageLiteral` не указывается, то происходит переключение в режим [автоматической установки](Icons.md#auto) иконки.

        - `imageLiteral`

            Строковый литерал, значение которого определяет иконку.

    - `NOIMAGE`

        Ключевое слово, указывающее на то, что иконка действия должна отсутствовать.

- `annotationSetting`

  Аннотация действия. Начинается с @@. Поддерживаются следующие аннотации:

    - `@@noauth`

      Отключение проверки авторизации при внешнем запросе для данного действия.

    - `@@api`

      При выключенном api разрешает внешний запрос для данного действия.

    - `@@deprecated`
    - `@@deprecated(since)`
    - `@@deprecated(since,message)`

      Пометка действия как устаревшего и не рекомендованного для использования. Плагин показывает использование таких действий перечёркнутым.

        - `since`

          Строковый литерал, версия платформы, начиная с которой действие считается устаревшим.

        - `message`

          Строковый литерал, сообщение, поясняющее, почему действие помечено устаревшим.

- `EXTID extID`

    Указание имени, которое будет использоваться для поиска действия при [обращении из внешней системы](Access_from_an_external_system.md#http).

### Блок значений по умолчанию инструкции `DESIGN`

- `CHANGEKEY key [SHOW | HIDE]`

    Указание [комбинации клавиш](Form_events.md#keyboard), при нажатии которой будет выполнено это действие. Устанавливает значение для [дизайна по умолчанию](Form_design.md#defaultDesign), может быть переопределено в [инструкции `DESIGN`](DESIGN_statement.md).

    - `key`

  [Строковый литерал](Literals.md#strliteral), описывающий комбинацию клавиш. Синтаксис:
  ```
  keyStroke [;(modeKey=modeValue;)*]
  ```

  	- `keyStroke`
  		Строковое представление комбинации клавиш. Принцип задания аналогичен способу задания параметра в методе Java-класса [Keystroke.getKeystroke(String)](http://docs.oracle.com/javase/7/docs/api/javax/swing/KeyStroke.html#getKeyStroke(java.lang.String)).
  		
  	- `(modeKey=modeValue;)*`
  		Опции, задающие условия выполнения для `keyStroke`. Поддерживаются следующие опции:
  		
  		- `priority = priorityValue` 
  			Приоритет, целочисленное значение. Если несколько действий имеют подходящий под условия `CHANGEKEY`, выполнится то, у которого приоритет будет выше.
  			Если приоритет не задан, он равняется порядковому номеру свойства на форме. Кроме того, в любом случае к значению приоритета добавляется 1000, если совпадает группа объектов.
  		
  		- `preview = previewValue`
  			Все события проверяются на выполнение дважды: сначала с isPreview=true, потом - с isPreview=false. Поддерживаемые значения `previewValue`:
  			- `AUTO`, `ONLY` -> isPreview
  			- `NO` -> !isPreview
  			- `ALL` -> true
  			
  		- `dialog = dialogValue`
  			Проверка, выполнять ли `CHANGEKEY` в диалоговом окне. Поддерживаемые значения `dialogValue`:
  			- `AUTO`, `ALL` -> true
  			- `ONLY` -> isDialog
  			- `NO` -> !isDialog
  			
  		- `window = windowValue`
  			Проверка, выполнять ли `CHANGEKEY` в модальном окне. Поддерживаемые значения `windowValue`:
  			- `AUTO`, `ALL` -> true
  			- `ONLY` -> isWindow
  			- `NO` -> !isWindow	
  		
  		- `group = groupValue`
  			Проверка, совпадает ли группа объектов. Поддерживаемые значения `groupValue`:
  			- `AUTO`, `ALL` -> true
  			- `ONLY` -> equalGroup
  			- `NO` -> !equalGroup
  		
  		- `editing = editingValue`
  			Проверка, выполнять ли `CHANGEKEY` в режиме редактирования свойства. Поддерживаемые значения `editingValue`:
  			- `AUTO` -> !(isEditing() && getEditElement().isOrHasChild(Element.as(event.getEventTarget())))
  			- `ALL` -> true
  			- `ONLY` -> isEditing
  			- `NO` -> !isEditing
  			
  		- `showing = showingValue`
  			Проверка, показывается ли в данный момент свойство на форме. Поддерживаемые значения `showingValue`:
  			- `AUTO`, `ONLY` -> isShowing
  			- `ALL` -> true
  			- `NO` -> !isShowing
  			
  		- `panel = panelValue`
  			Проверка, находится ли действие в панели. Поддерживаемые значения `panelValue`:
  			- `AUTO` -> !isMouse || !isPanel
  			- `ALL` -> true
  			- `ONLY` -> isPanel
  			- `NO` -> !isPanel	
  	
  		- `cell = cellValue`
  			Проверка, находится ли действие в таблице. Поддерживаемые значения `cellValue`:
  			- `AUTO` -> !isMouse || isCell
  			- `ALL` -> true
  			- `ONLY` -> isCell
  			- `NO` -> !isCell

  	
  		Для всех опций кроме `priority` значением по умолчанию является `AUTO`.	


    - `SHOW`
    
        Ключевое слово, при указании которого комбинация клавиш будет отображаться в заголовке действия. Используется по умолчанию.

    - `HIDE`
    
        Ключевое слово, при указании которого комбинация клавиш не будет отображаться в заголовке действия. 

- `CHANGEMOUSE key [SHOW | HIDE]`

  Указание комбинации клавиш мыши, при нажатии которых будет выполнено это действие. Устанавливает значение для дизайна по умолчанию, может быть переопределено в инструкции `DESIGN`.

    - `key`

  [Строковый литерал](Literals.md#strliteral), описывающий комбинацию клавиш. Синтаксис:
  ```
  keyStroke [;(modeKey=modeValue;)*]
  ```

  	- `keyStroke`
  		Строковое представление комбинации клавиш мыши. В данный момент единственное поддерживаемое значение - `DBLCLK` - двойной клик.
  		
  	- `(modeKey=modeValue;)*`
  		Синтаксис полностью совпадает с `CHANGEKEY`.		

    - `SHOW`

      Ключевое слово, при указании которого комбинация клавиш мыши будет отображаться в заголовке действия. Используется по умолчанию.

    - `HIDE`

      Ключевое слово, при указании которого комбинация клавиш мыши не будет отображаться в заголовке действия.

- `STICKY` | `NOSTICKY`

    Ключевые слова. `STICKY` указывает на то, что действие в таблице будет прикреплено слева и при скроллинге вправо будет оставаться видимым. `NOSTICKY` снимает это закрепление. По умолчанию `STICKY` или `NOSTICKY` вычисляется эвристически.

- `syncType`

  Определяет, выполняется действие синхронно или асинхронно:

    - `WAIT` - синхронно.
    - `NOWAIT` - асинхронно. Это значение используется по умолчанию.

- `CONFIRM`

    Ключевое слово. Если указано, то при запуске действия будет задан вопрос о подтверждении запуска. Устанавливает значение для дизайна по умолчанию, может быть переопределено в инструкции `DESIGN`.
